# 数探 - 高性能表格搜索工具

这是一个功能强大的桌面应用程序，用于加载、显示和搜索Excel或CSV表格文件，针对大型数据集进行了性能优化。

## 功能特点

- **多文件支持**：可同时加载多个Excel/CSV文件，并在它们之间切换
- **文件夹批量导入**：支持选择整个文件夹，自动导入所有Excel/CSV文件
- **拖放支持**：直接将文件拖放到程序窗口即可加载
- **多线程加载**：使用后台线程加载文件，保持界面响应
- **进度显示**：文件加载过程中显示进度条，可随时取消
- **大文件处理**：
  - 低内存模式：分块加载和处理超大文件
  - 智能数据类型优化：自动优化数据类型，减少内存占用
  - 内存监控：实时显示内存使用量
- **虚拟滚动表格**：高效显示大型数据集，支持百万级行数据
- **高级搜索选项**：
  - 全局搜索和按列搜索
  - 精确匹配和模糊匹配
  - 区分大小写选项
  - 整词匹配选项
  - 正则表达式支持
- **异步搜索**：大型数据集搜索在后台进行，不阻塞界面
- **搜索历史**：记录并可重用之前的搜索内容
- **结果高亮**：在表格中高亮显示搜索结果
- **结果导出**：支持将搜索结果导出为新文件
- **性能选项**：提供图形界面调整性能相关参数

## 安装说明

1. 确保已安装Python 3.6或更高版本
2. 克隆或下载此仓库
3. 安装依赖包：

```
pip install -r requirements.txt
```

## 使用方法

1. 运行应用程序：

```
python DataSeek.py
```

2. 加载文件：
   - 点击"选择文件"按钮，选择一个或多个Excel或CSV文件
   - 或点击"选择文件夹"按钮，导入整个文件夹中的所有Excel/CSV文件
   - 或直接将文件拖放到程序窗口
   - 加载过程中会显示进度条，可随时取消
   - 对于超大文件，可启用"低内存模式"

3. 搜索内容：
   - 在搜索框中输入要搜索的内容
   - 选择搜索模式（全局搜索或按列搜索）
   - 如果选择按列搜索，从下拉菜单中选择要搜索的列
   - 根据需要选择高级搜索选项（精确匹配、区分大小写、整词匹配、正则表达式）
   - 点击"搜索"按钮或按回车键执行搜索

4. 查看结果：
   - 搜索结果会显示在预览选项卡中
   - 表格支持排序功能
   - 右键菜单提供复制和导出功能
   - 可以通过工具栏中的"导出结果"按钮导出搜索结果

5. 性能调优：
   - 点击工具栏中的"性能选项"按钮
   - 根据需要调整内存管理和表格显示选项
   - 查看状态栏显示的内存使用情况

## 技术栈

- Python
- PyQt5（GUI框架）
- pandas（数据处理）
- numpy（数据类型优化）
- QThread（多线程支持）
- QAbstractTableModel（虚拟化表格模型）
- openpyxl/xlrd（Excel文件处理）
- psutil（内存监控）

## 性能优化技术

- **内存优化**：
  - 分块加载大文件
  - 自动优化数据类型（category类型、适当的整数/浮点类型）
  - 智能管理加载的数据块

- **界面响应优化**：
  - 异步文件加载和搜索
  - 虚拟化表格显示
  - 按需加载数据

- **大数据集处理**：
  - 针对百万级数据行的特殊处理
  - 搜索时显示进度和耗时
  - 内存使用监控

## 注意事项

- 对于大型文件，程序会自动使用分块读取技术，但仍可能需要较长时间
- 目前支持的文件格式：.xlsx, .xls, .csv
- 搜索历史会自动保存，下次启动程序时仍可使用